(function(e,t){"use strict";typeof define=="function"&&define.amd?define(["exports"],t):typeof exports!="undefined"?t(exports):t(e.fast={})})(this,function(e){function t(e,t){t||(t=function(e,t){return e===t});var n,r=2,i,s=e.length;if(s===0)return[];if(s===1)return[-1];r=0,n=[-1],i=-1;while(r<s){while(i>-1&&!t(e[r],e[i]))i=n[i];r+=1,i+=1,t(e[r],e[i])?n[r]=n[i]:n[r]=i}return n}function n(e,n,r,i){r||(r=function(e,t){return e===t});var s=0,o=0,u=e.length,a=n.length;if(u<a)return-1;if(a===0)return 0;if(u===a){for(s=0;s<u;s+=1)if(!r(e[s],n[s]))return-1;return 0}i=i||t(n,r);while(o<u){while(s>-1&&!r(e[o],n[s]))s=i[s];s+=1,o+=1;if(s>=a)return o-s}return-1}function r(e,t,n){n||(n=function(e,t){return e===t});if(e.length>t.length){var i=r(t,e,function(e,t){return n(t,e)});return{indicesA:i.indicesB,indicesB:i.indicesA,length:i.length,result:i.result}}if(e.length===0)return{indicesA:[],indicesB:[],length:0,result:[]};var s,o=t.length,u,a=e.length,f=0,l=[],f,c,h,p=[],d,v;for(s=0;s<o;s+=1){v=t[s],f=l.length,p=l.slice(0);for(u=0,c=0,h=0;u<a;u+=1)if(n(e[u],v)){while(c<f&&l[c].indexA<u)c+=1;while(h<f&&p[h].indexA<u)h+=1;if(!p[h]||p[h].indexA>u)p[h]={indexA:u,indexB:s,length:l[c-1]?l[c-1].length+1:1,trackBack:l[c-1]||null};l[c]?u=l[c].indexA:u=a}l=p}var m=[],g=[],y=l.length,b=l[y-1],w=[];for(s=y-1;s>=0;s-=1)w[s]=e[m[s]=b.indexA],g[s]=b.indexB,b=b.trackBack;return{indicesA:m,indicesB:g,length:y,result:w}}function i(e,t,n){n||(n=function(e,t){return e===t});if(e.length>t.length){var r=i(t,e,function(e,t){return n(t,e)});return{startA:r.startB,startB:r.startA,length:r.length,result:r.result}}if(e.length===0)return{startA:0,startB:0,length:0,result:[]};var s,o=t.length,u,a=e.length,f,l=0,c,h=[],p,d=0,v=-1,m=-1;for(s=0;s<o;s+=1){p=t[s],n(e[0],p)&&(h.push(0,1),d===0&&(d=1,v=0,m=s));for(u=1,f=0;u<a;u+=1)if(n(e[u],p)){while(f<l&&c[f]<u-1)f+=2;f<l&&c[f]===u-1?(h.push(u,c[f+1]+1),c[f+1]+1>d&&(d=c[f+1]+1,v=u,m=s),f+=2):(h.push(u,1),d===0&&(d=1,v=u,m=s))}c=h,h=[],l=c.length}return{startA:v-d+1,startB:m-d+1,length:d,result:e.slice(v-d+1,v+1)}}function s(e,t){return i(e.split(""),t.split(""),function(e,t){return e===t}).result.join("")}function o(e){var t=[],n=[],r=[];if(e.length===0)return r;t[1]=0,n[0]=-1;for(var i=1;i<e.length;i++){var s=e[i];if(e[t[1]]>s)n[i]=-1,t[1]=i;else if(e[t[t.length-1]]<s)n[i]=t[t.length-1],t.push(i);else{for(var o=1,u=t.length-1,a=o+u>>1;u>o+1;a=o+u>>1)e[t[a]]<s?o=a:u=a;n[i]=t[o],t[u]=i}}for(var f=t.length-1,l=t[f];l>=0;f--,l=n[l])r[f-1]=e[l];return r}function u(e,t){var n,r=e.length,i,s;t||(t=Math.random);for(n=r-2;n>0;n--){i=t()*(n+1);if(i>=n)continue;s=e[n],e[n]=e[i],e[i]=s}}function a(e,t){t===undefined&&(t=function(e,t){return e<t}),this._lessTest=t;if(e!==undefined){this._arr=e.slice(0);var n=this._arr,r,i=n.length,s;for(r=i-1;r>=0;r--)this._down(r)}else this._arr=[]}function f(e){e&&(this.lessTest=e)}function l(e){this.data=e}e.seq={},e.ds={},e.seq.KMPPreProcess=t,e.seq.KMP=n,e.seq.LCS=r,e.seq.LCStr=i,e.seq.LCStrStr=s,e.seq.LIS=o,e.seq.shuffle=u,a.prototype={_up:function(e){var t=this._arr,n=t[e],r=this._lessTest,i;do{i=e-1>>1;if(!r(n,t[i]))break;t[e]=t[i],e=i}while(e>0);t[e]=n},_down:function(e){var t=this._arr,n=this._lessTest,r=t[e],i,s,o=t.length;do{i=e*2+1,s=e*2+2;if(s>=o){i<o&&n(t[i],r)&&(t[e]=t[i],e=i);break}if(n(t[i],t[s])){if(!n(t[i],r))break;t[e]=t[i],e=i}else{if(!n(t[s],r))break;t[e]=t[s],e=s}}while(!0);t[e]=r},push:function(e){var t=this._arr;if(arguments.length>1)for(var n=0;n<arguments.length;n++)t.push(arguments[n]),this._up(t.length-1);else t.length===0?t.push(e):(t.push(e),this._up(t.length-1))},peek:function(){return this._arr[0]},pop:function(){var e=this._arr,t=e[0];return e.length>1?(e[0]=e[e.length-1],e.length--,this._down(0)):e.length=0,t},remove:function(e){var t=this._arr,n=-1,r=t.length-1;if(r===-1)return!1;if(t[r]===e)return t.length--,!0;while(n++<r)if(t[n]===e)return t[n]=t[r],t.length--,this._down(n),!0;return!1},size:function(){return this._arr.length}},e.ds.PriorityQueue=a,l.prototype={parent:null,red:!0,left:null,right:null,data:null},f.prototype={lessTest:function(e,t){return e<t},root:null,length:0,beforeNodeSwap:function(e,t){},search:function(e){return this._nodeSearch(this.root,e)},searchMaxSmallerThan:function(e){return this._nodeSearchMaxSmallerThan(this.root,e)},searchMinGreaterThan:function(e){return this._nodeSearchMinGreaterThan(this.root,e)},insert:function(e){return this.length===0?(this.length++,this.root=new l(e),this.root.red=!1,this.root):(this.length++,this._nodeInsert(this.root,e,this.lessTest))},first:function(){return this._nodeLeftMost(this.root)},last:function(){return this._nodeRightMost(this.root)},next:function(e){if(e.right)return this._nodeLeftMost(e.right);if(e.parent){var t=e;while(t.parent&&t.parent.left!==t)t=t.parent;return t.parent}return null},prev:function(e){if(e.left)return this._nodeRightMost(e.left);if(e.parent){var t=e;while(t.parent&&t.parent.right!==t)t=t.parent;return t.parent}return null},iterate:function(e,t){this.root&&this._nodeIterate(this.root,e,t)},remove:function(e){this.length&&this.removeNode(this.search(e))},removeNode:function(e){var t;e&&(e.right?(t=this._nodeLeftMost(e.right),this.swap(e,t),this._nodeRemoveMin(t)):this._nodeRemoveMin(e),this.length--)},swap:function(e,t){var n=e.data,r=t.data;this.beforeNodeSwap(e,t),e.data=r,t.data=n},_nodeLeftMost:function(e){while(e&&e.left)e=e.left;return e},_nodeRightMost:function(e){while(e&&e.right)e=e.right;return e},_nodeIsRed:function(e){return e&&e.red},_nodeSibling:function(e){return e&&e.parent?e==e.parent.left?e.parent.right:e.parent.left:null},_nodeColorFlip:function(e){e.red=!e.red,e.left.red=!e.left.red,e.right.red=!e.right.red},_nodeRotateLeft:function(e){var t=e.right;t.parent=e.parent,e.parent?e.parent.left==e?e.parent.left=t:e.parent.right=t:this.root=t,e.right=t.left,e.right&&(e.right.parent=e),t.left=e,e.parent=t},_nodeRotateRight:function(e){var t=e.left;t.parent=e.parent,e.parent?e.parent.right===e?e.parent.right=t:e.parent.left=t:this.root=t,e.left=t.right,e.left&&(e.left.parent=e),t.right=e,e.parent=t},_nodeSearch:function(e,t){var n=this.lessTest;while(e&&e.data!==t)n(t,e.data)?e=e.left:e=e.right;return e},_nodeSearchMaxSmallerThan:function(e,t){var n=this.lessTest,r=null;while(e)n(e.data,t)?(r=e,e=e.right):e=e.left;return r},_nodeSearchMinGreaterThan:function(e,t){var n=this.lessTest,r=null;while(e)n(t,e.data)?(r=e,e=e.left):e=e.right;return r},_nodeInsertFixUp:function(e){if(!e.parent)e.red=!1;else if(e.parent.red){var t=e.parent,n=t.parent,r=n.left===t?n.right:n.left;if(this._nodeIsRed(r))this._nodeColorFlip(n),this._nodeInsertFixUp(n);else{if(e===t.right&&t===n.left){n.left=e,e.parent=n;if(t.right=e.left)t.right.parent=t;e.left=t,t.parent=e,t=e,e=e.left}else if(e===t.left&&t===n.right){n.right=e,e.parent=n;if(t.left=e.right)t.left.parent=t;e.right=t,t.parent=e,t=e,e=e.right}t.red=!1,n.red=!0,e==t.left?this._nodeRotateRight(n):this._nodeRotateLeft(n)}}return e},_nodeInsert:function(e,t,n){var r;return n(t,e.data)?e.left?this._nodeInsert(e.left,t,n):(r=e.left=new l(t),e.left.parent=e,this._nodeInsertFixUp(e.left),r):e.right?this._nodeInsert(e.right,t,n):(r=e.right=new l(t),e.right.parent=e,this._nodeInsertFixUp(e.right),r)},_nodeRemoveFixUp:function(e,t,n){t!==null&&(this._nodeIsRed(n)&&(t.red=!0,n.red=!1,e===t.left?(this._nodeRotateLeft(t),n=t.right):(this._nodeRotateRight(t),n=t.left)),!this._nodeIsRed(n.left)&&!this._nodeIsRed(n.right)?(n.red=!0,this._nodeIsRed(t)?t.red=!1:this._nodeRemoveFixUp(t,t.parent,this._nodeSibling(t))):(e===t.left&&!this._nodeIsRed(n.right)&&this._nodeIsRed(n.left)?(n.red=!0,n.left.red=!1,this._nodeRotateRight(n),n=n.parent):e===t.right&&!this._nodeIsRed(n.left)&&this._nodeIsRed(n.right)&&(n.red=!0,n.right.red=!1,this._nodeRotateLeft(n),n=n.parent),n.red=t.red,t.red=!1,e===t.left?(this._nodeRotateLeft(t),n.right.red=!1):(this._nodeRotateRight(t),n.left.red=!1)))},_nodeIterate:function(e,t,n){e.left&&this._nodeIterate(e.left,t,n),t.call(n||this,e.data,e),e.right&&this._nodeIterate(e.right,t,n)},_nodeRemoveMin:function(e){var t=e.left||e.right,n=this._nodeSibling(e);t&&(t.parent=e.parent),e.parent?e.parent.left===e?e.parent.left=t:e.parent.right=t:this.root=t,e.red||(this._nodeIsRed(t)?t.red=!1:this._nodeRemoveFixUp(t,e.parent,n)),e.left=e.right=e.parent=null,e.red=!1}},e.ds.RedBlackTree=f});